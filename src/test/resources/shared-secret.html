<!doctype html>
<html>
	<head>
		<script src="Base58.js"></script>
		<script src="nacl_factory.js"></script>
		<script>
			nacl_factory.instantiate(function (nacl) {
				var mintingAccountPrk = 'A9MNsATgQgruBUjxy2rjWY36Yf19uRioKZbiLFT2P7c6';
				// var recipientAccountPuk = 'C6wuddsBV3HzRrXUtezE7P5MoRXp5m3mEDokRDGZB6ry';
				var recipientAccountPuk = '2sbcMmVKke5inS4yrbeoG6Cyw2mZCptQNjyWgnY4YHaF';

				mintingAccountPrk = Base58.decode(mintingAccountPrk);
				recipientAccountPuk = Base58.decode(recipientAccountPuk);

				var mintingKeyPair = nacl.crypto_box_keypair_from_raw_sk(mintingAccountPrk);

				// Expecting: A9MNsATgQgruBUjxy2rjWY36Yf19uRioKZbiLFT2P7c6
				console.log("minting private key (for confirmation): " + Base58.encode(mintingKeyPair.boxSk));

				// This WILL NOT be: 2tiMr5LTpaWCgbRvkPK8TFd7k63DyHJMMFFsz9uBf1ZP because this is an X25519 keypair, not Ed25519 keypair?
				// console.log("minting PUBLIC key: " + Base58.encode(mintingKeyPair.boxPk));

				var sharedSecret = nacl.crypto_scalarmult(mintingKeyPair.boxSk, recipientAccountPuk);
				console.log("shared secret (for debugging): " + Base58.encode(sharedSecret));
				console.log(sharedSecret); // log as Uint8Array

				var proxyPrivateKey = nacl.crypto_hash_sha256(sharedSecret)
				console.log("proxy private key: " + Base58.encode(proxyPrivateKey));

				var proxyKeyPair = nacl.crypto_sign_seed_keypair(proxyPrivateKey);
				console.log("proxy public key: " + Base58.encode(proxyKeyPair.signPk));
			});
		</script>
	</head>
	<body>
	</body>
</html>